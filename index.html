<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DB손보 펫 플랫폼</title>
    <link rel="stylesheet" href="assets/css/reset.css">
    <link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
    <div id="wrap">
        <header>
            <img src="assets/image/main1/1.png" alt="" class="scroll-eff">
            <button type="button" class="down-btn scroll-eff"><img src="assets/image/main1/1-1.png" alt=""></button>
            <p class="h-bnr"><img src="assets/image/main1/5.png" alt=""></p>
        </header>
        <main>
            <button type="button" class="close-btn"><img src="assets/image/main1/2.png" alt=""></button>
            <div class="main-box">
                <div class="tab">
                    <a href=""><img src="assets/image/main1/tab_h.png" alt=""></a>
                    <ul>
                        <li><a href=""><img src="assets/image/main1/tab1.png" alt=""></a></li>
                        <li><a href=""><img src="assets/image/main1/tab2.png" alt=""></a></li>
                        <li><a href=""><img src="assets/image/main1/tab3.png" alt=""></a></li>
                        <li><a href=""><img src="assets/image/main1/tab4.png" alt=""></a></li>
                        <li><a href=""><img src="assets/image/main1/tab5.png" alt=""></a></li>
                    </ul>
                </div>

                <a href=""><img src="assets/image/main1/4.png" alt=""></a>
                <a href="" class="trigger-pop"><img src="assets/image/main1/5.png" alt=""></a>
                <a href=""><img src="assets/image/main1/6.png" alt=""></a>
                <a href=""><img src="assets/image/main1/7.png" alt=""></a>
                <a href="" class="box3-btn"><img src="assets/image/main1/8.png" alt=""></a>
                <a href="#" class="box2-btn"><img src="assets/image/main1/9.png" alt=""></a>
                <a href=""><img src="assets/image/main1/10.png" alt=""></a>
                <a href=""><img src="assets/image/main1/11.png" alt=""></a>
            </div>
            <!-- <div class="open-pop">
                <button type="button"><img src="assets/image/main1/13.png" alt=""></button>
            </div> -->

            <div class="box1">
                <img src="assets/image/main1/14.png" alt="" class="box1-top">
                <img src="assets/image/main1/close.png" alt="" class="box1-close">

                <div class="box1-in">
                    <img src="assets/image/main1/15.png" alt="">
                    <button type="button"><img src="assets/image/main1/16.png" alt="">꼬미 사진자랑하기</button>
                </div>

                <img src="assets/image/main1/17.png" alt="" class="box1-bottom">

                <button type="button" class="box1-pop1"><img src="assets/image/main1/18.png" alt=""></button>

                <div class="box1-pop2">
                    <button type="button"><img src="assets/image/main1/19.png" alt=""><img src="assets/image/main1/20.png" alt=""></button>
                </div>

                <div class="box1-pop3">
                    <button type="button"><img src="assets/image/main1/21.png" alt=""></button>
                </div>

                <div class="box1-pop4">
                    <img src="assets/image/main1/22.png" alt="">
                    <img src="assets/image/main1/close.png" alt="" class="box1-close">
                    <p><img src="assets/image/main1/24.png" alt=""></p>
                    <button type="button">
                        <img src="assets/image/main1/23.png" alt="">
                    </button>
                </div>

                <div class="box1-pop5">
                    <img src="assets/image/main1/25.png" alt="">
                    <button type="button"><img src="assets/image/main1/close.png" alt="" class="box1-close"></button>
                </div>
            </div>

            <div class="box2">
                <button type="button"><img src="assets/image/main1/26.png" alt=""></button>
            </div>

            <div class="box3">
                <button type="button" class="box3-step1"><img src="assets/image/main1/27.png" alt=""></button>
                <button type="button" class="box3-step2"><img src="assets/image/main1/28.png" alt=""></button>

                <button type="button" class="box3-step3">
                    <img src="assets/image/main1/29.png" alt="">
                </button>
                <button type="button" class="box3-step4">
                    <img src="assets/image/main1/30.png" alt="">
                </button>
                <button type="button" class="box3-step5">
                    <img src="assets/image/main1/31.png" alt="">
                </button>
            </div>
        </main>
        <footer>
            <p class="gnb-m"><img src="assets/image/main1/12.png" alt=""></p>
        </footer>
    </div>
    <script src="assets/js/main.js"></script>
</body>
</html>

<script>
const headerbanner = () => {
    const banner = document.querySelector(".h-bnr");

    window.addEventListener("scroll", function () {
    if (window.scrollY > 0 && banner && !banner.classList.contains("hidden")) {
        banner.classList.add("hidden");
    }
    });
}

const scrolleff = () => {
    const items = document.querySelectorAll(".scroll-eff");

    const observer = new IntersectionObserver(
        (entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const el = entry.target;
                    const index = Array.from(items).indexOf(el);
                    el.style.transitionDelay = `${index * 0.1}s`;
                    el.classList.add("show");
                    observer.unobserve(el);
                }
            });
        },
        {
            threshold: 0.01
        }
    );

    items.forEach(item => {
        observer.observe(item);
    });
};

const popClose = () => {
    const btn = document.querySelector('.close-btn');
    const mainBox = document.querySelector('.main-box');

    btn.addEventListener('click', () => {
        btn.classList.add('hide');
        setTimeout(() => {
            btn.style.display = 'none';
            const offset = 30;
            const target = mainBox.getBoundingClientRect().top + window.scrollY - offset;

            scrollToSlow(target, 30);
        }, 300);
    });
};

const scrollToCloseBtn = () => {
    const downBtn = document.querySelector('.down-btn.scroll-eff');
    const closeBtn = document.querySelector('.close-btn');

    if (!downBtn || !closeBtn) return;

    downBtn.addEventListener('click', () => {
        const offset = 30;
        const target = closeBtn.getBoundingClientRect().top + window.scrollY - offset;
        scrollToSlow(target, 30);
    });
};

function scrollToSlow(targetY, speed = 20) {
    const currentY = window.scrollY;
    const distance = targetY - currentY;
    let step = distance / speed;

    function scroll() {
        const newY = window.scrollY + step;

        if ((step > 0 && newY >= targetY) || (step < 0 && newY <= targetY)) {
            window.scrollTo(0, targetY);
            return;
        }

        window.scrollTo(0, newY);
        requestAnimationFrame(scroll);
    }

    requestAnimationFrame(scroll);
}

const openPopOnScroll = () => {
    const trigger = document.querySelector('.trigger-pop');
    const openPop = document.querySelector('.open-pop');
    let shown = false;

    if (!trigger || !openPop) return;

    const checkVisibility = () => {
        const rect = trigger.getBoundingClientRect();
        const windowHeight = window.innerHeight;

        if (rect.top < windowHeight / 4.5 && !shown) {
            openPop.style.display = 'flex';
            openPop.classList.add('fade-in');
            shown = true;
        }
    };

    window.addEventListener('scroll', checkVisibility);
    window.addEventListener('load', checkVisibility);
};

const openPopBox1 = () => {
    const btn = document.querySelector('.open-pop button');
    const pop = document.querySelector('.open-pop');
    const box1 = document.querySelector('.box1');
    const box1In = document.querySelector('.box1-in');
    const box1Inbtn = document.querySelector('.box1-in button');
    const box1pop1Btn = document.querySelector('.box1-pop1');
    const box1pop2wrap = document.querySelector('.box1-pop2');
    const box1pop3wrap = document.querySelector('.box1-pop3');
    const box1pop4wrap = document.querySelector('.box1-pop4');
    const box1pop5wrap = document.querySelector('.box1-pop5');
    

    btn.addEventListener('click', () => {
        box1.classList.add('on');

        setTimeout(() => {
            box1In.classList.add('on');
        }, 500);
    });

    box1Inbtn.addEventListener('click', () => {
        box1Inbtn.classList.add('on');

        setTimeout(() => {
            box1pop1Btn.classList.add('on');
        }, 400);
    });

    box1pop1Btn.addEventListener('click', () => {
        box1pop2wrap.classList.add('on');
    });

    box1pop2wrap.addEventListener('click', () => {
        box1pop2wrap.classList.remove('on');
        box1pop1Btn.classList.remove('on');

        box1In.addEventListener('click', () => {
            box1pop3wrap.classList.add('on');
        });
    });

    box1pop3wrap.addEventListener('click', () => {
        box1pop3wrap.classList.remove('on');
        box1pop4wrap.classList.add('on');
    });

    box1pop4wrap.addEventListener('click', () => {
        box1pop5wrap.classList.add('on');
        box1pop4wrap.classList.remove('on');
    });

    box1pop5wrap.addEventListener('click', e => {
        box1pop5wrap.classList.remove('on');
        box1.classList.remove('on');
        pop.classList.remove('fade-in');
        openPop.style.display = 'none';
    });
}

const openPopBox2 = () => {
    const box2 = document.querySelector('.box2');
    const box2Openbtn = document.querySelector('.box2-btn');
    const box2Closebtn = box2.querySelector('button');

    box2Openbtn.addEventListener('click', e => {
        e.preventDefault();
        e.stopPropagation();
        box2.classList.add('on');
    });

    box2Closebtn.addEventListener('click', () => {
        box2.classList.remove('on');
    })
}

const openPopBox3 = () => {
    const box3 = document.querySelector('.box3');
    const box3Openbtn = document.querySelector('.box3-btn');
    const box3Closebtn = box3.querySelector('button');
    const box3Step1 = document.querySelector('.box3-step1');
    const box3Step2 = document.querySelector('.box3-step2');
    const box3Step3 = document.querySelector('.box3-step3');
    const box3Step4 = document.querySelector('.box3-step4');
    const box3Step5 = document.querySelector('.box3-step5');


    box3Openbtn.addEventListener('click', e => {
        e.preventDefault();
        e.stopPropagation();
        box3.classList.add('on');
        box3Step1.classList.add('on');
    });

    box3Step1.addEventListener('click', () => {
        box3Step1.classList.remove('on');
        box3Step1.style.display = "none";
        box3Step2.classList.add('on');
    });

    box3Step2.addEventListener('click', () => {
        box3Step2.style.display = "none";
        box3Step2.classList.remove('on');
        box3Step3.classList.add('on');
    });

    box3Step3.addEventListener('click', () => {
        box3Step3.style.display = "none";
        box3Step3.classList.remove('on');
        box3Step4.classList.add('on');
    });

    box3Step4.addEventListener('click', () => {
        box3Step4.style.display = "none";
        box3Step4.classList.remove('on');
        box3Step5.classList.add('on');
    });

    box3Step5.addEventListener('click', () => {
        box3Step5.style.display = "none";
        box3Step5.classList.remove('on');
        box3.classList.remove('on');
    });
}

document.addEventListener("DOMContentLoaded", () => {
    headerbanner();
    scrolleff();
    popClose();
    scrollToCloseBtn();
    openPopOnScroll();
    // openPopBox1();
    openPopBox2();
    openPopBox3();
});
</script>